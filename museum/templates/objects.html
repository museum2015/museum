<!DOCTYPE html>
<html>
{% load staticfiles %}
<head lang="en">
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="{% static "static/table.css" %}"/>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script type="text/javascript" language="javascript" src="{% static "js/TF_Modules/tablefilter.js" %}"></script>
</head>
<body>
<div>
<table id="table1">
    <thead>
    <tr>
							<th id="number0">ID</th>
							<th>Назва</th>
							<th id="number1">Кількість</th>
                            <th>Статус</th>
    </tr>
    </thead>
    <tbody>
    {% for a in objects %}
    <tr><td>{{ a.id }}</td><td>{{ a.name }}</td><td>{{ a.amount }}</td><td>{{ a.status }}</td>
    {% endfor %}
    </tbody>
</table>
<input type='button' onclick='ret()' value='Повернення з тимчасового зберігання' class='button0'>
<input type='button' onclick='ts_ps()' value='Прийняти на постійне зберігання' class='button1'>
<input type='button' onclick='io()' value='Поставити на інвентарний облік' class='button2'>
<input type='button' onclick='ps_ts()' value='Повернення предмета з ПЗ на ТЗ' class='button3'>
<input type='button' onclick='ts_ps()' value='Повернення предмета з ТЗ на ПЗ' class='button4'>
<input type='button' onclick='send_ps()' value='Передача на постійне зберігання' class='button5'>
<input type='button' onclick='writing_off()' value='Списати' class='button6'>
{% if add %}
    <input type='button' onclick='' value='Створити' class='button7'>
{% endif %}
{% if change %}
    <input type='button' onclick='' value='Редагувати' class='button8'>
{% endif %}
{% if remove %}
    <input type='button' onclick='' value='Видалити' class='button9'>
{% endif %}
</div>
<script type="text/javascript">
        var remove_attr = function() {
            i = 0;
            but = $(".button"+i);
            while(but.length > 0) {
                but.removeAttr("disabled");
                i++;
                but = $(".button"+i);
            };
        };

        $( document ).ready(remove_attr());

        var $table = $('table'),
        $bodyCells = $table.find('tbody tr:first').children(),
        colWidth;

        $bodyCells.each(function(i, v) {
            $(v).width($(v).width() + 50);
        });

        colWidth = $bodyCells.map(function() {
            return $(this).width();
        }).get();

        $table.find('thead tr').children().each(function(i, v) {
            $(v).width(colWidth[i]);
        });

        var rows = $('tr').not(':first');

        /* Create 'click' event handler for rows */
        rows.on('click', function(e) {

            /* Get current row */
            var row = $(this);

            rows.removeClass('highlight');
            row.addClass('highlight');

            remove_attr();

            if ($(".highlight td:nth-child(4)").text() == "Приймання на тимчасове зберігання") $(".button3").attr("disabled", "");

            if ($(".highlight td:nth-child(4)").text() == "Приймання на постійне зберігання"){
                $(".button0").attr("disabled", "");
                $(".button4").attr("disabled", "");
                };

        });


        $(document).bind('selectstart dragstart', function(e) {
            e.preventDefault(); return false;
        });

        var table_props =  {
                    col_0: "none",
                    col_5: "select",
                    display_all_text: " [ Show all ] ",
                    sort_select: true,
                    paging: true,
                    paging_length: 20,
                    rows_counter: true,
                    rows_counter_text: "Рядки:",
                    btn_reset: false,
                    btn_next_page_html: '<a href="javascript:;" style="margin:3px;">Наступна ></a>',
                    btn_prev_page_html: '<a href="javascript:;" style="margin:3px;">< Попередня</a>',
                    btn_last_page_html: '<a href="javascript:;" style="margin:3px;"> Остання >|</a>',
                    btn_first_page_html: '<a href="javascript:;" style="margin:3px;"><| Перша</a>',
                    loader: true,
                    loader_html: '<h4 style="color:red;">Завантаження, будь ласка зачекайте...</h4>',
                    sort: true,
                    sort_config: {
                        sort_types:['Number', 'String', 'Number', 'String'],
                    }
    };


        var tf = setFilterGrid("table1", table_props);
        var ts_ps = function() {
            var t = $(".highlight td:first-child").text();
            var link = "/staff/add_on_ps/" + t;
            window.location.replace(link);
        };
        var writing_off = function() {
            var t = $(".highlight td:first-child").text();
            var link = "/staff/writing_off/" + t;
            window.location.replace(link);
        };
        var io = function() {
            var t = $(".highlight td:first-child").text();
            var link = "/staff/inventory_save/" + t;
            window.location.replace(link);
        };
        var ps_ts = function() {
            var t = $(".highlight td:first-child").text();
            var link = "staff/ps_to_ts/" + t;
            window.location.replace(link);
        };
        var ts_ps = function() {
            var t = $(".highlight td:first-child").text();
            var link = "staff/ts_to_ps/" + t;
            window.location.replace(link);
        };
        var send_ps = function() {
            var t = $(".highlight td:first-child").text();
            var link = "staff/send_on_ps/" + t;
            window.location.replace(link);
        };
        var ret = function() {
            var t = $(".highlight td:first-child").text();
            var link = "/staff/return/" + t;
            window.location.replace(link);
        };


</script>
</body>
</html>